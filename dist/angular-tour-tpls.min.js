!function(){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(a){a.put("tour/tour.tpl.html",'<div class="tour-tip">\n    <span class="tour-arrow tt-{{ placement }}"></span>\n    <div class="tour-content-wrapper">\n        <p ng-bind="content"></p>\n        <a ng-click="nextAction()" ng-bind="nextLabel" class="small button tour-next-tip"></a>\n        <a ng-click="closeAction()" class="tour-close-tip">Ã—</a>\n    </div>\n</div>')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:500,offset:28,postTourCallback:function(){},postStepCallback:function(){}}).controller("TourController",["$scope","OrderedList","tourConfig","tourState",function(a,b,c,d){{var e=this;e.steps=b.getInstance()}a.$on("tourshow",function(){d.started(),a.openTour()}),a.$on("tourclose",function(){a.endTour(!0)});var f=function(a){e.steps.first()===a?e.select(a):a.tt_open=!1};e.selectAtIndex=function(a){e.steps.get(a)&&e.select(e.steps.get(a))},e.getCurrentStep=function(){return e.currentStep},e.select=function(a){function b(){e.currentStep&&(e.currentStep.tt_open=!1),e.currentStep=a,e.currentIndex=c,a.tt_open=!0}var c=e.steps.indexOf(a);a?b():e.tourCompleted()},e.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?e.steps.set(a.index,a):e.steps.push(a)},e.cancelTour=function(){e.endTour(!0),d.ended()},e.endTour=function(b){e.steps.forEach(function(a){a.tt_open=!1}),c.postTourCallback(e.currentIndex),b||a.$emit("onTourEnd")},e.startTour=function(){d.isActive()&&e.steps.forEach(function(a){f(a)})},a.openTour=function(){e.startTour()},a.closeTour=function(){e.endTour()},e.tourCompleted=function(){e.endTour()},e.next=function(){var a=e.currentIndex+1;a+1>e.steps.getCount()&&e.tourCompleted(),c.postStepCallback(a),e.select(e.steps.get(a))}}]).directive("tour",function(){return{controller:"TourController",scope:{},restrict:"EA",link:function(){}}}).directive("tourtip",["$window","$compile","$interpolate","$timeout","scrollTo","tourConfig",function(a,b,c,d,e,f){var g=c.startSymbol(),h=c.endSymbol(),i='<div tour-popup next-label="'+g+"tt_next_label"+h+'" content="'+g+"tt_content"+h+'" placement="'+g+"tt_placement"+h+'" next-action="tt_next_action()" close-action="tt_close_action()" is-open="'+g+"tt_open"+h+'" ></div>';return{require:"^tour",restrict:"EA",scope:{},link:function(c,g,h,j){function k(){var b,d,h,i,j,k,l;if(c.tt_content){c.tt_animation?m.fadeIn():m.css({display:"block"}),g.after(m),l=g.children().eq(0).length>0?g.children().eq(0):g;var n=function(){switch(b=l.position(),d=m.width(),h=m.height(),k=l.width(),j=l.height(),c.tt_placement){case"right":i={top:b.top,left:b.left+k+c.tt_offset};break;case"bottom":i={top:b.top+j+c.tt_offset,left:b.left};break;case"left":i={top:b.top,left:b.left-d-c.tt_offset};break;default:i={top:b.top-h-c.tt_offset,left:b.left}}i.top+="px",i.left+="px",m.css(i),e(m,-200,-300,f.scrollSpeed)};angular.element(a).bind("resize."+c.$id,function(){n()}),n()}}function l(){m.detach(),angular.element(a).unbind("resize."+c.$id)}c.tt_content=h.tourtip,c.tt_placement=h.tourtipPlacement||f.placement,c.tt_next_label=h.tourtipNextLabel||f.nextLabel,c.tt_offset=h.tourtipOffset?parseInt(h.tourtipOffset,10):f.offset,c.tt_open=!1,c.tt_animation=f.animation,c.tt_next_action=j.next,c.tt_close_action=j.cancelTour,c.index=parseInt(h.tourtipStep,10);var m=b(i)(c);j.addStep(c),d(function(){j.startTour()},500),c.$watch("tt_open",function(a){a?(j.select(c),k()):l()}),c.$on("$destroy",function(){angular.element(a).unbind("resize."+c.$id),m.remove(),m=null})}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:{content:"@",nextLabel:"@",placement:"@",nextAction:"&",closeAction:"&",isOpen:"@"},restrict:"EA",link:function(){}}}).factory("OrderedList",function(){var a=function(){this.map={},this._array=[]};a.prototype.set=function(a,b){if(angular.isNumber(a))if(a in this.map)this.map[a]=b;else{if(a<this._array.length){var c=a-1>0?a-1:0;this._array.splice(c,0,a)}else this._array.push(a);this.map[a]=b,this._array.sort(function(a,b){return a-b})}},a.prototype.indexOf=function(a){for(var b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return Number(b)},a.prototype.push=function(a){var b=this._array[this._array.length-1]+1||0;this._array.push(b),this.map[b]=a,this._array.sort(function(a,b){return a-b})},a.prototype.remove=function(a){var b=this._array.indexOf(a);if(-1===b)throw new Error("key does not exist");this._array.splice(b,1),delete this.map[a]},a.prototype.get=function(a){return this.map[a]},a.prototype.getCount=function(){return this._array.length},a.prototype.forEach=function(a){for(var b,c,d=0;d<this._array.length;d++)b=this._array[d],c=this.map[b],a(c,b)},a.prototype.first=function(){var a,b;return a=this._array[0],b=this.map[a]};var b={getInstance:function(){return new a}};return b}).factory("scrollTo",function(){return function(a,b,c,d){a?(b=b||-100,c=c||-100,d=d||500,$("html,body").stop().animate({scrollTop:a.offset().top+b,scrollLeft:a.offset().left+c},d)):$("html,body").stop().animate({scrollTop:0},d)}}).service("tourState",function(){var a=this;a._tourIsActive=!1,a.isActive=function(){return a._tourIsActive},a.started=function(){a._tourIsActive=!0},a.ended=function(){a._tourIsActive=!1}})}(window,document);