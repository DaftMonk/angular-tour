!function(a,b,c){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(a){a.put("tour/tour.tpl.html",'<div class="tour-tip">\n    <span class="tour-arrow tt-{{ ttPlacement }}" ng-hide="centered"></span>\n    <div class="tour-content-wrapper">\n        <h3 ng-bind="ttTitle"></h3>\n        <p ng-bind="ttContent"></p>\n        <a ng-click="proceed()" ng-bind="ttNextLabel" class="small button tour-next-tip"></a>\n        <a ng-click="closeTour()" class="tour-close-tip">&times;</a>\n    </div>\n</div>\n')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:500,margin:28,backDrop:!1,useSourceScope:!1,containerElement:"body"}).controller("TourController",["$scope","orderedList",function(a,b){var c=this,d=c.steps=b(),e=!0;c.postTourCallback=angular.noop,c.postStepCallback=angular.noop,c.showStepCallback=angular.noop,c.currentStep=-1,a.$watch(function(){return c.currentStep},function(a){e?e=!1:c.select(a)}),c.select=function(a){if(angular.isNumber(a)){c.unselectAllSteps();var b=d.get(a);b&&(b.ttOpen=!0),c.currentStep!==a&&(c.currentStep=a),c.currentStep>-1&&c.showStepCallback(),a>=d.getCount()&&c.postTourCallback(!0),c.postStepCallback()}},c.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?d.set(a.index,a):d.push(a)},c.unselectAllSteps=function(){d.forEach(function(a){a.ttOpen=!1})},c.cancelTour=function(){c.unselectAllSteps(),c.postTourCallback(!1)},a.openTour=function(){var a=c.currentStep>=d.getCount()||c.currentStep<0?0:c.currentStep;c.select(a)},a.closeTour=function(){c.cancelTour()}}]).directive("tour",["$parse","$timeout","tourConfig",function(a,c,d){return{controller:"TourController",restrict:"EA",scope:!0,link:function(e,f,g,h){if(!angular.isDefined(g.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";var i=a(g.step),j=!1;e.$watch(g.step,function(a){h.currentStep=a}),h.postTourCallback=function(a){angular.element(b.querySelector(".tour-backdrop")).remove(),j=!1,angular.element(b.querySelector(".tour-element-active")).removeClass("tour-element-active"),a&&angular.isDefined(g.tourComplete)&&e.$parent.$eval(g.tourComplete),angular.isDefined(g.postTour)&&e.$parent.$eval(g.postTour)},h.postStepCallback=function(){angular.isDefined(g.postStep)&&e.$parent.$eval(g.postStep)},h.showStepCallback=function(){d.backDrop&&(angular.element(b.querySelector(d.containerElement)).append(angular.element('<div class="tour-backdrop"></div>')),c(function(){$(".tour-backdrop").remove(),angular.element('<div class="tour-backdrop"></div>').insertBefore(".tour-tip")},1e3),j=!0)},e.setCurrentStep=function(a){i.assign(e.$parent,a),h.currentStep=a},e.getCurrentStep=function(){return h.currentStep}}}}]).directive("tourtip",["$window","$compile","$interpolate","$timeout","scrollTo","tourConfig","debounce","$q",function(d,e,f,g,h,i,j,k){var l=(f.startSymbol(),f.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,link:function(f,m,n,o){function p(){var a=f.ttElement?angular.element(b.querySelector(f.ttElement)):m,c=f;return a===m||f.ttSourceScope||(c=a.scope()),c}function q(b,c){var d,e,g=0,h=b[0].getBoundingClientRect(),i=h.top+a.pageYOffset,j=0;if(c&&c[0]){i=i-c[0].getBoundingClientRect().top+c[0].scrollTop,"fixed"===c.css("position")&&(j=c[0].getBoundingClientRect().left);var k=c[0].getBoundingClientRect().width;$(u).width()+h.width>k&&(d=k-h.left+f.ttMargin)}var l=u.width()||$(u).width(),m=u.height()||$(u).height();switch(f.ttPlacement){case"right":var n=h.left-j+h.width+f.ttMargin+f.offsetHorizontal;e={top:i+f.offsetVertical,left:n>0?n:g};break;case"bottom":var n=h.left-j+f.offsetHorizontal;e={top:i+h.height+f.ttMargin+f.offsetVertical,left:n>0?n:g};break;case"center":var n=h.left-j+.5*(h.width-l)+f.offsetHorizontal;e={top:i+.5*(h.height-m)+f.ttMargin+f.offsetVertical,left:n>0?n:g};break;case"center-top":var n=h.left-j+.5*(h.width-l)+f.offsetHorizontal;e={top:i+.1*(h.height-m)+f.ttMargin+f.offsetVertical,left:n>0?n:g};break;case"left":var n=h.left-j-l-f.ttMargin+f.offsetHorizontal;e={top:i+f.offsetVertical,left:n>0?n:g,right:d};break;default:var n=h.left-j+f.offsetHorizontal;e={top:i-m-f.ttMargin+f.offsetVertical,left:n>0?n:g}}return e.top+="px",e.left+="px",e}function r(){if(f.ttContent){f.ttAnimation?u.fadeIn():u.css({display:"block"});var a=f.ttElement?angular.element(b.querySelector(f.ttElement)):m;if(null==a||0===a.length)throw"Target element could not be found. Selector: "+f.ttElement;angular.element(b.querySelector(f.ttContainerElement)).append(u);var e=function(){var d="body"===f.ttContainerElement?c:angular.element(b.querySelector(f.ttContainerElement)),e=q(a,d);u.css(e);var g=parseInt(e.top),j=parseInt(e.left);h(u,f.ttContainerElement,-150,-300,i.scrollSpeed,g,j)};if(i.backDrop&&t(a),angular.element(d).bind("resize."+f.$id,j(e,50)),e(),f.onStepShow){var k=p();g(function(){k.$eval(f.onStepShow)},300)}}}function s(){u.detach(),angular.element(d).unbind("resize."+f.$id)}function t(a){angular.element(b.querySelector(".tour-element-active")).removeClass("tour-element-active"),f.centered||a.addClass("tour-element-active")}n.$observe("tourtip",function(a){f.ttContent=a}),n.$observe("tourtipPlacement",function(a){f.ttPlacement=(a||i.placement).toLowerCase().trim(),f.centered=0===f.ttPlacement.indexOf("center")}),n.$observe("tourtipNextLabel",function(a){f.ttNextLabel=a||i.nextLabel}),n.$observe("tourtipContainerElement",function(a){f.ttContainerElement=a||i.containerElement}),n.$observe("tourtipMargin",function(a){f.ttMargin=parseInt(a,10)||i.margin}),n.$observe("tourtipOffsetVertical",function(a){f.offsetVertical=parseInt(a,10)||0}),n.$observe("tourtipOffsetHorizontal",function(a){f.offsetHorizontal=parseInt(a,10)||0}),n.$observe("onShow",function(a){f.onStepShow=a||null}),n.$observe("onProceed",function(a){f.onStepProceed=a||null}),n.$observe("tourtipElement",function(a){f.ttElement=a||null}),n.$observe("tourtipTitle",function(a){f.ttTitle=a||null}),n.$observe("useSourceScope",function(a){f.ttSourceScope=a?"true"===a:i.useSourceScope}),f.ttNextLabel=i.nextLabel,f.ttContainerElement=i.containerElement,f.ttPlacement=i.placement.toLowerCase().trim(),f.centered=!1,f.ttMargin=i.margin,f.offsetHorizontal=0,f.offsetVertical=0,f.ttSourceScope=i.useSourceScope,f.ttOpen=!1,f.ttAnimation=i.animation,f.index=parseInt(n.tourtipStep,10);var u=e(l)(f);o.addStep(f),g(function(){f.$watch("ttOpen",function(a){a?r():s()})},500),f.$on("$destroy",function(){angular.element(d).unbind("resize."+f.$id),u.remove(),u=null}),f.proceed=function(){if(f.onStepProceed){var a=p(),b=a.$eval(f.onStepProceed);k.resolve(b).then(function(){f.setCurrentStep(f.getCurrentStep()+1)})}else f.setCurrentStep(f.getCurrentStep()+1)}}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:!0,restrict:"EA",link:function(a,b,c){}}}).factory("orderedList",function(){var a=function(){this.map={},this._array=[]};a.prototype.set=function(a,b){if(angular.isNumber(a))if(a in this.map)this.map[a]=b;else{if(a<this._array.length){var c=a-1>0?a-1:0;this._array.splice(c,0,a)}else this._array.push(a);this.map[a]=b,this._array.sort(function(a,b){return a-b})}},a.prototype.indexOf=function(a){for(var b in this.map)if(this.map.hasOwnProperty(b)&&this.map[b]===a)return Number(b)},a.prototype.push=function(a){var b=this._array[this._array.length-1]+1||0;this._array.push(b),this.map[b]=a,this._array.sort(function(a,b){return a-b})},a.prototype.remove=function(a){var b=this._array.indexOf(a);if(-1===b)throw new Error("key does not exist");this._array.splice(b,1),delete this.map[a]},a.prototype.get=function(a){return this.map[a]},a.prototype.getCount=function(){return this._array.length},a.prototype.forEach=function(a){for(var b,c,d=0;d<this._array.length;d++)b=this._array[d],c=this.map[b],a(c,b)},a.prototype.first=function(){var a,b;return a=this._array[0],b=this.map[a]};var b=function(){return new a};return b}).factory("scrollTo",function(){return function(a,b,c,d,e,f,g){a?(c=c||-100,d=d||-100,e=e||500,$("html,"+b).stop().animate({scrollTop:f+c,scrollLeft:g+d},e)):$("html,"+b).stop().animate({scrollTop:0},e)}}).factory("debounce",["$timeout","$q",function(a,b){return function(c,d,e){var f,g=b.defer();return function(){var h=this,i=arguments,j=function(){f=null,e||(g.resolve(c.apply(h,i)),g=b.defer())},k=e&&!f;return f&&a.cancel(f),f=a(j,d),k&&(g.resolve(c.apply(h,i)),g=b.defer()),g.promise}}}])}(window,document);